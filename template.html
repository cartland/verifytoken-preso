<!--
Google IO 2013: Cross-Platform Auth with Google+ Sign-In

Authors: Chris Cartland <cartland@google.com>
         Francis Ma <fma@google.com>

Based on template by:
         Eric Bidelman <ebidel@gmail.com>
         Luke Mah√© <lukem@google.com>

URL: https://code.google.com/p/io-2012-slides
-->
<!DOCTYPE html>
<html>
<head>
  <title></title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="theme/css/default.css">
  <link rel="stylesheet" media="all" href="theme/css/io2013.css">
  <link rel="stylesheet" media="all" href="theme/css/cartland.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="logoslide nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/google_developers_logo.png"></span>
    </article>
  </slide>

  <slide class="title-slide segue nobackground">
    <aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
    </hgroup>
  </slide>

  <slide>
    <hgroup>
      <h2>When</h2>
    </hgroup>
    <article class="flexbox vcenter" class="larger">
      <img width="400px" src="images/verify-request.png" alt="Client Talking To Your Server" title="Client Talking To Your Server"><br />
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>When</h2>
    </hgroup>
    <article class="flexbox vcenter" class="larger">
      <img width="400px" src="images/verify-request-focus.png" alt="Client Talking To Your Server" title="Client Talking To Your Server"><br />
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>When</h2>
    </hgroup>
    <article class="flexbox vcenter" class="larger">
      <ul>
        <b>Try other options first</b>
        <p>
        <li>Use the code exchange if possible</li>
        <li>Authenticate the session for multiple requests</li>
        <p>
        <p>
        <b>But what if...</b>
        <p>
        <li>You can't create a session (e.g. cannot store cookies)</li>
        <li>The authorization code is not available on your platform (iOS)
      </ul>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Android</h2>
      <h3>Authorization Code<h3>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="Android">
try {
  <b>String code = GoogleAuthUtil.getToken(this,
      mPlusClient.getAccountName(),
      "oauth2:server:client_id:" + CLIENT_ID
      + ":api_scope:" + TextUtils.join(' ', SCOPES));</b>
} catch (UserRecoverableAuthException e) {
  // Recover
} catch (Exception e) {
  throw new RuntimeException(e);
}
</pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Android</h2>
      <h3>ID Token</h3>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="Android">
try {
  <b>String id_token = GoogleAuthUtil.getToken(this,
      mPlusClient.getAccountName(),
      "audience:server:client_id:" + CLIENT_ID);</b>
} catch (UserRecoverableAuthException e) {
  // Recover
} catch (Exception e) {
  throw new RuntimeException(e);
}
</pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Android</h2>
      <h3>Access Token</h3>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="Android">
try {
  <b>String access_token = GoogleAuthUtil.getToken(this,
      mPlusClient.getAccountName(),
      "oauth2:" + TextUtils.join(' ', SCOPES));</b>
} catch (UserRecoverableAuthException e) {
  // Recover
} catch (Exception e) {
  throw new RuntimeException(e);
}
</pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Web</h2>
      <h3>Sign-In Button</h3>
    </hgroup>
    <article class="larger">
      <pre class="prettyprint" data-lang="HTML">
&lt;span id="signinButton"&gt;
  &lt;span
    class="g-signin"
    <b>data-callback="signinCallback"</b>
    data-clientid="CLIENT_ID"
    data-cookiepolicy="single_host_origin"
    data-scope="https://www.googleapis.com/auth/plus.login"&gt;
  &lt;/span&gt;
&lt;/span&gt;

&lt;!-- Place plusone.js asynchronous JavaScript
     just before your &lt;/body&gt; tag -->
</pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>Web</h2>
      <h3>Callback</h3>
    </hgroup>
    <article class="larger">
      <pre class="prettyprint" data-lang="JavaScript">
function <b>signinCallback(authResult)</b> {
  <b>if (authResult['access_token']) {
    var code = authResult['code'];
    var id_token = authResult['code'];
    var access_token = authResult['access_token'];
    // Send authorization code
  }</b> else if (authResult['error']) {
    // User is not signed in.
  }
}
</pre>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>iOS</h2>
      <h3>Access Token Only</h3>
    </hgroup>
    <article>
      <pre class="prettyprint" data-lang="Objective-C">
<b>- (void)finishedWithAuth:(GTMOAuth2Authentication *)auth
                   error:(NSError *)error {
  NSString *accessToken = auth.accessToken;</b>
  if (error) {
    signInAuthStatus_.text =
        [NSString stringWithFormat:@"Status: Authentication error: %@", error];
    return;
  }
  [self reportAuthStatus];
}
</pre>
    </article>
    <img class="corner-placemark" src="images/server-auth.png" class="reflect" alt="Server Auth" title="Server Auth">
  </slide>

  <slide>
    <hgroup>
      <h2>Why Verify</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <ul>
        <li>Invalid tokens (obvious)</li>
        <li>Tokens for other apps</li>
      </ul>
      <img width="400px" src="images/verify-request-bad.png" alt="Client Talking To Your Server" title="Client Talking To Your Server"><br />
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>How</h2>
    </hgroup>
    <article class="flexbox vcenter">
      <ul>
        <li>Good tokens are made by Google</li>
        <li>Check that tokens are for your app</li>
      </ul>
      <img width="400px" src="images/verify-request-bad.png" alt="Client Talking To Your Server" title="Client Talking To Your Server"><br />
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>How</h2>
      <h3>Send one of these tokens with every request</h3>
    </hgroup>
    <article class="flexbox vcenter" style="margin-top: -50px;">
      <p>
      <p>
      <table>
        <tr>
          <th></th>
          <th>ID Token</th>
          <th>Access Token</th>
        </tr>
        <tr>
          <td>1. Issued by Google</td>
          <td>Check signature</td>
          <td>Call tokeninfo API</td>
        </tr>
        <tr>
          <td>2. Check Your Client ID</td>
          <td>Read token</td>
          <td>Read tokeninfo response</td>
        </tr>
        <tr>
          <td>3. Get User ID</td>
          <td>Read token</td>
          <td>Read tokeninfo response</td>
        </tr>
      </table>
    </article>
  </slide>

  <slide>
    <hgroup>
      <h2>How</h2>
      <h3>GitHub Samples</h3>
    </hgroup>
    <article class="flexbox vcenter" style="margin-top: -20px;">
      <table>
        <tr>
          <th>Language</th>
          <th>Sample</th>
        </tr>
        <tr>
          <td>
            C#
          </td>
          <td>
            <a href="https://github.com/googleplus/gplus-verifytoken-csharp">
              https://github.com/googleplus/gplus-verifytoken-csharp
            </a>
          </td>
        </tr>
        <tr>
          <td>
            Java
          </td>
          <td>
            <a href="https://github.com/googleplus/gplus-verifytoken-java">
              https://github.com/googleplus/gplus-verifytoken-java
            </a>
          </td>
        </tr>
        <tr>
          <td>
            PHP
          </td>
          <td>
            <a href="https://github.com/googleplus/gplus-verifytoken-php">
              https://github.com/googleplus/gplus-verifytoken-php
            </a>
          </td>
        </tr>
        <tr>
          <td>
            Python
          </td>
          <td>
            <a href="https://github.com/googleplus/gplus-verifytoken-python">
              https://github.com/googleplus/gplus-verifytoken-python
            </a>
          </td>
        </tr>
        <tr>
          <td>
            Ruby
          </td>
          <td>
            <a href="https://github.com/googleplus/gplus-verifytoken-ruby">
              https://github.com/googleplus/gplus-verifytoken-ruby
            </a>
          </td>
        </tr>
      </table>
    </article>
  </slide>

  <slide class="thank-you-slide segue nobackground">
    <aside class="gdbar right"><img src="images/google_developers_icon_128.png"></aside>
    <article class="flexbox vleft auto-fadein">
      <h2>&lt;Thank You!&gt;</h2>
      <h3>Verifying Tokens</h3>
      <p>github.com/googleplus</p>
    </article>
    <p class="auto-fadein" data-config-contact>
      <!-- populated from slide_config.json -->
    </p>
  </slide>

  <slide class="logoslide dark nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/google_developers_logo_white.png"></span>
    </article>
  </slide>

  <slide class="backdrop"></slide>

</slides>

<script>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXXX-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
